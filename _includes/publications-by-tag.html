{%- comment -%}
Include to render publications filtered by a specific tag.
Usage:
  {% include publications-by-tag.html tag="group_research" title="Group research" %}

Parameters:
 - tag: the tag to filter by (required)
 - title: optional display title for the section
{%- endcomment -%}

{%- assign tag = include.tag -%}
{%- assign title = include.title | default: tag | replace: '_', ' ' | capitalize -%}

<h3>{{ title }}</h3>
{%- comment -%}
Use a variable name in the where_exp expression (Liquid/where_exp can reference outer variables like `tag`).
Avoid string interpolation which can prevent correct evaluation.
{%- endcomment -%}
{%- assign filtered = site.data.publications | where_exp: "p", "p.tags contains tag" -%}
{%- assign sorted = filtered | sort: 'year' | reverse -%}
{%- if sorted.size > 0 -%}
  <ul>
  {%- for pub in sorted -%}
    <li>
      {{ pub.authors }} â€” <em>{{ pub.title }}</em>, {{ pub.venue }} ({{ pub.year }}){%- if pub.url %}. <a href="{{ pub.url }}" target="_blank" rel="noopener">link</a>{%- endif %}
    </li>
  {%- endfor -%}
  </ul>
{%- else -%}
  <p><em>No publications listed under '{{ tag }}'.</em></p>
{%- endif -%}
